"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.IncomingRequestManager = void 0;
const EventEmitter = require("eventemitter3");
const uuid = require("uuid");
// TODO: need audio client docs
/**
 * An object that manages the incoming conversation requests.
 *
 * @see {@link Application.incoming}
 *
 * It has a `request` event, with arguments being and `endpoint` string,
 * and an `additionalInfo` string.
 *
 * @example handling a simple incoming request
 * ```typescript
 * application.incoming.on("request", async (endpoint) => {
 *   const conversation = application.createConversation({ endpoint });
 *   await conversation.execute();
 * });
 * ```
 */
class IncomingRequestManager extends EventEmitter {
    /** @internal */
    constructor(application, log) {
        super();
        this._isDisposed = false;
        this._handleAudioClientInviteRequest = (audioClientId, additionalInfo) => {
            const roomId = uuid.v4();
            const endpoint = this._application._getAudioClientEndpoint(audioClientId, roomId);
            this.emit("request", endpoint, additionalInfo);
        };
        this._application = application;
        this._log = log;
        this._application.on("_audioClientInviteRequest", this._handleAudioClientInviteRequest);
    }
    /** @internal */
    _dispose() {
        if (this._isDisposed)
            return;
        this._isDisposed = true;
        this._application.off("_audioClientInviteRequest", this._handleAudioClientInviteRequest);
    }
}
exports.IncomingRequestManager = IncomingRequestManager;
//# sourceMappingURL=incoming.js.map